<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>For Loops</title>

<script src="site_libs/header-attrs-2.23/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="tutorial.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Biol 520C Statistical modelling for biological data &mdash; UBC-Okanagan</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="Lectures.html">Lectures</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Practicals
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="01_R_Introduction.html">Practical 01</a>
    </li>
    <li>
      <a href="02_Regression.html">Practical 02</a>
    </li>
    <li>
      <a href="03_MLR_Residuals.html">Practical 03</a>
    </li>
    <li>
      <a href="04_Visualisation.html">Practical 04</a>
    </li>
    <li>
      <a href="05_MEM_Model_Selection.html">Practical 05</a>
    </li>
    <li>
      <a href="06_Heteroskedasticity_Autocorrelation.html">Practical 06</a>
    </li>
    <li>
      <a href="07_Spatial_and_Phylogenetic_Autocorrelation.html">Practical 07</a>
    </li>
    <li>
      <a href="08_GLMs_for_Count_Data.html">Practical 08</a>
    </li>
    <li>
      <a href="09_Logistic_Regression.html">Practical 09</a>
    </li>
    <li>
      <a href="10_Stochastic_Simulation.html">Practical 10</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Datasets
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Practical_Datasets.html">Practicals</a>
    </li>
    <li>
      <a href="Paper_Datasets.html">Papers</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    R Help
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Plotting.html">Plotting</a>
    </li>
    <li>
      <a href="for_loops.html">for loops</a>
    </li>
    <li>
      <a href="Simulation.html">Simulation</a>
    </li>
  </ul>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">For Loops</h1>

</div>


<p>This page was last updated on February 01, 2024.</p>
<hr />
<div id="background" class="section level2">
<h2>Background</h2>
<p>This page provides some basic guidance on repeating a blocked
sequence of instructions using for loops.</p>
<hr />
</div>
<div id="for-loop-basics" class="section level2">
<h2><code>for</code> loop basics</h2>
<p>The <code>for</code> loop is probably the simplest way to carry out a
repeated task without having to type (or copy/paste/edit) the same code
over and over. In essence, a for loop is a way to repeat a blocked
sequence of instructions, allowing you to automate parts of your code
that are in need of repetition.</p>
<p>An easy way to understand what is going on in the <code>for</code>
loop is by reading it as follows: For each number from 1 to the last
number of your index (5 in the example below), you execute the code
chunk <code>{...}</code> that immediately follows (in the example below
we just print the index). Once the for loop has executed the code chunk
for every number (i.e., iteration) in the sequence you defined at the
outset, the loop stops.</p>
<pre class="r"><code>for(i in 1:5){
  print(i)
}</code></pre>
<pre><code>## [1] 1
## [1] 2
## [1] 3
## [1] 4
## [1] 5</code></pre>
<p>There are a few basic things to note about for loops. The first is
that the index does not have to be called <code>i</code>. We can call it
anything we like. We usually use <code>i</code> and <code>j</code>
because these line up with the standard row and column notation from
matrix algebra, but we could just as easily use the word
<code>ROW</code> (or any other word we might want).</p>
<pre class="r"><code>for(ROW in 1:5){
  print(ROW)
}</code></pre>
<pre><code>## [1] 1
## [1] 2
## [1] 3
## [1] 4
## [1] 5</code></pre>
<p>Another thing to note is that a <code>for</code> loop does not need
to contain the index. It will loop a sequence of code whether it
contains the index or not. The index is just a useful way to not only
repeat a process, but make incremental changes in the behaviour of a
loop.</p>
<pre class="r"><code>for(i in 1:5){
  print(&quot;hello world&quot;)
}</code></pre>
<pre><code>## [1] &quot;hello world&quot;
## [1] &quot;hello world&quot;
## [1] &quot;hello world&quot;
## [1] &quot;hello world&quot;
## [1] &quot;hello world&quot;</code></pre>
<pre class="r"><code>for(i in 1:5){
  print(paste(&quot;hello world, I&#39;m replicate&quot;, i))
}</code></pre>
<pre><code>## [1] &quot;hello world, I&#39;m replicate 1&quot;
## [1] &quot;hello world, I&#39;m replicate 2&quot;
## [1] &quot;hello world, I&#39;m replicate 3&quot;
## [1] &quot;hello world, I&#39;m replicate 4&quot;
## [1] &quot;hello world, I&#39;m replicate 5&quot;</code></pre>
<p>For loops also don’t have to start at 1, and they don’t have to be
perfect sequences of numbers. They can run backwards, start and end at
any number you chose, have gaps, or even be characters. For example, any
of these for loops will run without issue.</p>
<pre class="r"><code>for(i in 3:7){print(i)}</code></pre>
<pre><code>## [1] 3
## [1] 4
## [1] 5
## [1] 6
## [1] 7</code></pre>
<pre class="r"><code>for(i in 5:1){print(i)}</code></pre>
<pre><code>## [1] 5
## [1] 4
## [1] 3
## [1] 2
## [1] 1</code></pre>
<pre class="r"><code>for(i in c(1,3,5,7)){print(i)}</code></pre>
<pre><code>## [1] 1
## [1] 3
## [1] 5
## [1] 7</code></pre>
<pre class="r"><code>for(i in c(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;)){print(i)}</code></pre>
<pre><code>## [1] &quot;A&quot;
## [1] &quot;B&quot;
## [1] &quot;C&quot;</code></pre>
<hr />
</div>
<div id="saving-the-results-of-a-for-loop" class="section level2">
<h2>Saving the results of a <code>for</code> loop</h2>
<p>Generally, when you automate a repetitive task you will also want to
save the results after the loop has completed running. For example, you
might want to generate 50 random samples from a Gaussian distribution,
each with <span class="math inline">\(n\)</span> = 10, and calculate the
mean each time. The following loop will accomplish this</p>
<pre class="r"><code>for(i in 1:50){
  SAMPLE &lt;- rnorm(n = 10)
  mean(SAMPLE)
}</code></pre>
<p>The problem with this setup is that after the loop has finished
running, there are no results to inspect. This is because everything
that happens within the blocked code of a <code>for</code> loop happens
within an internal environment, and we need to take extra steps to pull
the results out of the loop. Otherwise, the results of an iteration will
disappear after it has completed. In this example we are expecting a
single number to be returned from the loop (the estimated mean). If we
have a single number to save, the best way is to place it in the
appropriate ‘slot’ in a vector (i.e., the first mean should go in slot
1, the second mean in slot 2, and so on…). To save the results in a
vector, we first need to create a vector before running the loop. Inside
the loop all we need to do then is save the result from each iteration
<code>i</code> into the <code>i</code>’th element of the vector using
standard sub-setting notation <code>[]</code>.</p>
<pre class="r"><code>MEANS &lt;- vector()

for(i in 1:50){
  SAMPLE &lt;- rnorm(n = 10)
  MEANS[i] &lt;- mean(SAMPLE)
}

head(MEANS)</code></pre>
<pre><code>## [1] -0.1775737 -0.0120650  0.4525612  0.1553435 -0.2097950  0.5872926</code></pre>
<p>Generally speaking it’s best practice to define the length of the
vector before running the for loop. This is because ‘growing’ the length
of a variable in a for loop is computationally inefficient and can slow
down your code. For simple tasks the difference is trivial, but for
complex tasks the slow downs can be very important. Best practice for
the previous loop would look like this:</p>
<pre class="r"><code>MEANS &lt;- vector(&quot;numeric&quot;, length = 50)

for(i in 1:50){
  SAMPLE &lt;- rnorm(n = 10)
  MEANS[i] &lt;- mean(SAMPLE)
}</code></pre>
<p>Sometimes we might want more than a single piece of information from
a loop. For example, let’s say we wanted to save not only the mean of
each sample, but the standard deviation. One simple way to do this is to
have a vector for each results.</p>
<pre class="r"><code>MEANS &lt;- vector(&quot;numeric&quot;, length = 50)
SDs &lt;- vector(&quot;numeric&quot;, length = 50)

for(i in 1:50){
  SAMPLE &lt;- rnorm(n = 10)
  MEANS[i] &lt;- mean(SAMPLE)
  SDs[i] &lt;- sd(SAMPLE)
}

head(MEANS)</code></pre>
<pre><code>## [1] -0.186639084  0.008442812 -0.533903073  0.495030095  0.497541277
## [6]  0.189455788</code></pre>
<pre class="r"><code>head(SDs)</code></pre>
<pre><code>## [1] 0.9269096 1.2981547 1.1123793 0.6905977 0.5738516 1.1041033</code></pre>
<p>But this can quickly get unwieldy if we have a lot of information we
want to save. Another option is to save our outputs in lists. Lists are
extremely flexible ways of storing information.</p>
<pre class="r"><code>RESULTS &lt;- list()

for(i in 1:50){
  SAMPLE &lt;- rnorm(n = 10)
  MEAN &lt;- mean(SAMPLE)
  SD &lt;- sd(SAMPLE)
  VAR &lt;- var(SAMPLE)
  
  RESULTS[[i]] &lt;- c(MEAN, SD, VAR)
}

head(RESULTS)</code></pre>
<pre><code>## [[1]]
## [1] -0.005398288  1.319705093  1.741621533
## 
## [[2]]
## [1] -0.0358038  1.2360660  1.5278591
## 
## [[3]]
## [1] -0.2184938  0.9955905  0.9912004
## 
## [[4]]
## [1] 0.07120882 1.33249896 1.77555349
## 
## [[5]]
## [1] 0.3029196 0.7935969 0.6297960
## 
## [[6]]
## [1] -0.0722519  1.0216039  1.0436746</code></pre>
<p>Here each slot in the list contains a vector of length 3 which
contains the estimated mean, standard deviation, and variance. Storing
results in a list is very convenient because everything gets stored in
the same object, but working with the results can be challenging. To
make it easier to inspect the results of a for loop stored in a list, a
bit of post-processing is required to get the data back into an easy to
work with format.</p>
<pre class="r"><code>RESULTS_CLEAN &lt;- do.call(rbind, RESULTS)
RESULTS_CLEAN &lt;- data.frame(RESULTS_CLEAN)
names(RESULTS_CLEAN) &lt;- c(&quot;mean&quot;, &quot;sd&quot;, &quot;var&quot;)
head(RESULTS_CLEAN)</code></pre>
<pre><code>##           mean        sd       var
## 1 -0.005398288 1.3197051 1.7416215
## 2 -0.035803800 1.2360660 1.5278591
## 3 -0.218493836 0.9955905 0.9912004
## 4  0.071208817 1.3324990 1.7755535
## 5  0.302919574 0.7935969 0.6297960
## 6 -0.072251903 1.0216039 1.0436746</code></pre>
<hr />
</div>
<div id="nested-for-loops" class="section level2">
<h2>Nested for loops</h2>
<p>Sometimes we’re interested in repeating a repeated task. This can be
done using nested for loops (i.e., a for loop inside a for loop). With
nested for loops the ‘outer’ loop controls the number of repetition of
the whole block, while the inner loop executes n-times every time the
outer for loop. For example let’s say I want to estimate the means of
datasets with sample sizes ranging between 1 and 20, but I’m not just
interested in estimating each of these means a single time, but in the
variance of 100 means for each sample size. We could do this using
nested for loops as follows.</p>
<pre class="r"><code>#Number of replicates
nReps &lt;- 100

#list to store high level results
Var_Of_Means &lt;- list()

#Outer loop over the different sample sizes of interest
for(i in 1:20){
  
  #Vector to store internal results (note: will re-write each iteration of outer loop)
  MEANS &lt;- vector(&quot;numeric&quot;, length = nReps)
  
  #Inner loop over the desired number of replicates
  for(j in 1:nReps){
    SAMPLE &lt;- rnorm(n = i)
    MEANS[j] &lt;- mean(SAMPLE)
    
  } #Closes inner loop
  
  #Store the results of each iteration of the inner loop
  Var_Of_Means[[i]] &lt;- data.frame(n = i,
                                   variance = var(MEANS))
  
} #Closes outer loop

#Clean up and view the results
results &lt;- do.call(rbind, Var_Of_Means)

#Plot the change in variance of sample means as a function of n
plot(results$variance ~ results$n)</code></pre>
<p><img src="for_loops_files/figure-html/unnamed-chunk-11-1.png" width="576" /></p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
